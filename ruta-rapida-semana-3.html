<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ruta R√°pida Semana 3 - Flask Essentials</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" />
  <style>
    body{font-family:Segoe UI,Tahoma,Arial,sans-serif;background:#f5f5f5;margin:0;padding:24px;color:#222;}
    .wrap{max-width:960px;margin:0 auto;background:#fff;padding:32px 40px 48px;box-shadow:0 2px 8px rgba(0,0,0,.08);}
    h1{margin:0 0 12px;font-size:26px;color:#1a237e}
    h2{margin:28px 0 12px;font-size:20px;color:#1a237e;display:flex;align-items:center;gap:8px;border-bottom:2px solid #e0e0e0;padding-bottom:6px}
    .block{background:#f8f9fa;border-left:4px solid #1a237e;padding:18px;margin:18px 0;border-radius:8px;}
    .ok{border-left-color:#2e7d32;background:#e8f5e9}
    .warn{border-left-color:#ff9800;background:#fff3e0}
    pre[class*="language-"]{border-radius:8px;margin:10px 0}
    code[class*="language-"]{font-size:13px}
    a.btn{display:inline-block;background:#1a237e;color:#fff;text-decoration:none;padding:8px 14px;border-radius:6px;font-size:14px;}
    a.btn:hover{background:#283593}
    .mini{font-size:12px;color:#555}
    ul,ol{margin-left:22px}
  </style>
</head>
<body>
  <div class="wrap">
    <p><a href="sesion-clase-semana-3.html" class="btn"><i class="fas fa-arrow-left"></i> Volver a Sesi√≥n 3</a></p>
    <h1><i class="fas fa-bolt"></i> Ruta R√°pida Semana 3</h1>
    <p style="font-size:14px;line-height:1.6;">Gu√≠a ultracondensada para que armes un mini proyecto Flask con: rutas, plantilla, formulario, retroalimentaci√≥n y una gr√°fica. Ideal si est√°s abrumado por la gu√≠a completa. Puedes imprimir mentalmente esta secuencia: <strong>Ruta ‚Üí Plantilla ‚Üí Formulario ‚Üí Acci√≥n ‚Üí Feedback ‚Üí Visualizaci√≥n</strong>.</p>

    <h2><i class="fas fa-map-signs"></i> 1. ¬øQu√© es Flask?</h2>
    <div class="block">
      <p style="font-size:14px;">Framework minimalista en Python que permite definir <strong>rutas</strong> (URLs) y devolver respuestas (HTML, texto, JSON). Piensa: ‚ÄúSi visitan <code>/</code>, respondo con una p√°gina‚Äù.</p>
      <pre><code class="language-python">from flask import Flask, render_template
app = Flask(__name__)

@app.route('/')            # Ruta ra√≠z
def home():
    return render_template('hola.html')  # devuelve plantilla

if __name__ == '__main__':
    app.run(debug=True)</code></pre>
      <pre><code class="language-html"><!-- templates/hola.html -->
<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <title>Hola</title>
  </head>
  <body>
    <h1>Hola üëã</h1>
    <p>Esta p√°gina viene desde Flask usando una plantilla.</p>
  </body>
</html></code></pre>
    </div>

    <h2><i class="fas fa-route"></i> 2. ¬øC√≥mo funcionan las rutas?</h2>
    <div class="block">
      <ol style="font-size:14px;line-height:1.5;">
        <li><strong>Decorador</strong> <code>@app.route('/')</code> se ejecuta al iniciar y registra la URL.</li>
        <li><strong>Funci√≥n</strong> debajo retorna el contenido que ver√° el usuario.</li>
        <li><strong>Par√°metros</strong>: <code>@app.route('/item/&lt;int:id&gt;')</code> pasa <code>id</code> a la funci√≥n.</li>
        <li><strong>M√©todos HTTP</strong>: agrega <code>methods=['POST']</code> para formularios que modifican datos.</li>
        <li><strong>Estructura CRUD</strong>: separa listar / crear / editar / eliminar en rutas claras.</li>
      </ol>
      <pre><code class="language-python">@app.route('/estudiantes')
def listar(): ...

@app.route('/estudiantes/nuevo', methods=['POST'])
def crear(): ...

@app.route('/estudiantes/<int:id>/editar', methods=['POST'])
def editar(id): ...

@app.route('/estudiantes/<int:id>/eliminar', methods=['POST'])
def eliminar(id): ...</code></pre>
      <p class="mini">Convenci√≥n ayuda a que otros entiendan tu c√≥digo sin explicaciones largas.</p>
    </div>

    <h2><i class="fas fa-file-code"></i> 3. Plantilla + flash (retroalimentaci√≥n)</h2>
    <div class="block">
      <pre><code class="language-python">from flask import Flask, render_template, request, redirect, url_for, flash
app = Flask(__name__); app.secret_key='dev'

@app.route('/')
def home():
    return render_template('hola.html')

@app.route('/enviar', methods=['POST'])
def enviar():
    nombre = request.form.get('nombre','').strip()
    if not nombre:
        flash('Ingresa tu nombre','danger'); return redirect(url_for('home'))
    flash(f'Hola, {nombre}!','success'); return redirect(url_for('home'))</code></pre>
      <pre><code class="language-html"><!-- templates/hola.html (fragmento) -->
<h1 class="h3">Hola üëã</h1>
{% for cat,msg in get_flashed_messages(with_categories=True) %}
  <div class="alert alert-{{cat}}" role="alert">{{ msg }}</div>
{% endfor %}
<form method="post" action="/enviar" class="vstack gap-2">
  <input name="nombre" placeholder="Tu nombre" required class="form-control" />
  <button class="btn btn-primary">Enviar</button>
</form></code></pre>
    </div>

    <h2><i class="fas fa-shapes"></i> 4. Bootstrap (estilos r√°pidos)</h2>
    <div class="block">
      <p style="font-size:14px;">Incorpora dise√±o responsive sin escribir CSS desde cero.</p>
      <pre><code class="language-html"><!-- head -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<!-- body (antes de cerrar) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script></code></pre>
      <pre><code class="language-html"><button class="btn btn-primary">Guardar</button>
<div class="alert alert-success">Todo bien</div>
<table class="table table-striped">...</table>
<form class="row g-2"> <input class="form-control" /> </form></code></pre>
      <p class="mini">Clases clave: <code>container</code>, <code>row</code>, <code>col-md-4</code>, <code>btn btn-danger</code>, <code>alert alert-warning</code>.</p>
    </div>

    <h2><i class="fas fa-code"></i> 5. requirements.txt</h2>
    <div class="block">
      <p style="font-size:14px;">Lista dependencias para instalar en servidores como Render.</p>
      <pre><code class="language-text">Flask==3.0.0
gunicorn==21.2.0
Jinja2==3.1.2
Werkzeug==3.0.0
click==8.1.7
# pysqlite3-binary==0.5.3 (solo si tu Python no incluye sqlite3)</code></pre>
      <pre><code class="language-bash">python -m venv .venv
source .venv/Scripts/activate     # PowerShell: ./.venv/Scripts/Activate.ps1
pip install Flask gunicorn
pip freeze > requirements.txt</code></pre>
      <p class="mini">Edita manualmente si <code>freeze</code> mete muchas librer√≠as que no necesitas.</p>
    </div>

    <h2><i class="fas fa-chart-bar"></i> 6. Chart.js (gr√°fica b√°sica)</h2>
    <div class="block">
      <pre><code class="language-html"><canvas id="grafica" height="120"></canvas>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const ctx = document.getElementById('grafica').getContext('2d');
new Chart(ctx, {
  type:'bar',
  data:{labels:['A','B','C'], datasets:[{label:'Valores', data:[3,5,2], backgroundColor:'#1976d2'}]}
});
</script></code></pre>
      <p class="mini">Para datos din√°micos crea un endpoint Flask que retorne JSON y haz <code>fetch('/api/datos')</code>.</p>
    </div>

    <h2><i class="fas fa-database"></i> 7. Mini CRUD + SQLite</h2>
    <div class="block">
      <pre><code class="language-python">import sqlite3

def get_conn():
    c = sqlite3.connect('demo.db'); c.row_factory = sqlite3.Row; return c

def init_db():
    with get_conn() as c:
        c.execute('''CREATE TABLE IF NOT EXISTS est (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            nombre TEXT, grado TEXT, promedio REAL
        )''')

# CREATE
@app.route('/crear', methods=['POST'])
def crear():
    n = request.form['nombre']; g = request.form['grado']; p = float(request.form['promedio'])
    with get_conn() as c:
        c.execute('INSERT INTO est(nombre,grado,promedio) VALUES(?,?,?)',(n,g,p))
    flash('Creado','success'); return redirect('/')</code></pre>
      <pre><code class="language-python"># READ
@app.route('/')
def lista():
    with get_conn() as c:
        data = c.execute('SELECT id,nombre,grado,promedio FROM est').fetchall()
    return render_template('inicio.html', est=data)

# UPDATE
@app.route('/editar/<int:id>', methods=['POST'])
def editar(id):
    n = request.form['nombre']; g = request.form['grado']; p = float(request.form['promedio'])
    with get_conn() as c:
        c.execute('UPDATE est SET nombre=?, grado=?, promedio=? WHERE id=?',(n,g,p,id))
    flash('Actualizado','info'); return redirect('/')

# DELETE
@app.route('/eliminar/<int:id>', methods=['POST'])
def eliminar(id):
    with get_conn() as c:
        c.execute('DELETE FROM est WHERE id=?',(id,))
    flash('Eliminado','warning'); return redirect('/')</code></pre>
    </div>

    <h2><i class="fas fa-cloud-upload-alt"></i> 8. Despliegue Render (pasos m√≠nimos)</h2>
    <div class="block ok">
      <ol style="font-size:14px;line-height:1.5;">
        <li>A√±ade <code>requirements.txt</code> y <code>Procfile</code>.</li>
        <li>Sube a GitHub.</li>
        <li>Render ‚Üí New Web Service ‚Üí conecta repo.</li>
        <li>Start command: <code>gunicorn app:app</code>.</li>
        <li>Verifica la URL (c√≥digo 200 y CRUD operativo).</li>
      </ol>
      <pre><code class="language-text">Procfile
web: gunicorn app:app --log-file -</code></pre>
    </div>

    <h2><i class="fas fa-terminal"></i> 9. Comandos esenciales</h2>
    <div class="block">
      <pre><code class="language-bash"># Entorno
python -m venv .venv
source .venv/Scripts/activate

# Instalar dependencias
pip install Flask gunicorn
pip freeze > requirements.txt

# Ejecutar
python app.py

# Crear DB manual
python -c "import db; db.init_db()"

# Git b√°sico
git init
git add .
git commit -m "Init"
git branch -M main
git remote add origin https://github.com/TU_USUARIO/TU_REPO.git
git push -u origin main</code></pre>
    </div>

    <h2><i class="fas fa-bug"></i> 10. Errores frecuentes</h2>
    <div class="block warn">
      <ul style="font-size:14px;line-height:1.5;">
        <li><strong>ImportError Flask</strong>: activar venv e instalar con <code>pip install Flask</code>.</li>
        <li><strong>no such table</strong>: ejecutar funci√≥n de inicializaci√≥n (crear tabla antes de usar rutas).</li>
        <li><strong>405 Method Not Allowed</strong>: falta <code>methods=['POST']</code> o el form no usa <code>method="post"</code>.</li>
        <li><strong>Gr√°fica vac√≠a</strong>: ID de canvas incorrecto o datos no coinciden.</li>
      </ul>
    </div>

    <p style="font-size:12px;color:#555;">Siguiente paso: pasar de ejemplos aislados a una estructura m√°s ordenada con base de datos y dashboard. Cuando esto funcione, vuelve a la gu√≠a completa para profundizar.</p>
  </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-markup.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
</body>
</html>