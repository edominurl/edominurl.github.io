<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hoja Resumen Semana 3</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" />
  <style>
    @media print { .no-print { display:none } body{padding:0} }
    body{font-family:Segoe UI,Arial,sans-serif; background:#fff; color:#222; margin:0;}
    .page{max-width:980px; margin:0 auto; padding:24px 24px 48px;}
    h1{font-size:22px; margin:0 0 12px;}
    h2{font-size:18px; margin:18px 0 8px; color:#1a237e}
    .grid{display:grid; grid-template-columns:1fr 1fr; gap:16px;}
    .card{border:1px solid #e0e0e0; border-left:4px solid #1976d2; padding:12px; border-radius:6px;}
    .card.warn{border-left-color:#ff9800}
    .card.ok{border-left-color:#2e7d32}
    pre{margin:10px 0;}
    .footer{margin-top:16px; font-size:12px; color:#666}
  </style>
</head>
<body>
  <div class="page">
    <div class="no-print" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px;">
      <a href="index.html" style="text-decoration:none; color:#1976d2"><i class="fas fa-arrow-left"></i> Volver</a>
      <button onclick="window.print()" class="no-print" style="background:#1976d2; color:#fff; border:0; padding:6px 12px; border-radius:4px; cursor:pointer"><i class="fas fa-print"></i> Imprimir</button>
    </div>
    <h1><i class="fas fa-file-alt"></i> Hoja Resumen â€” Semana 3 (Flask + CRUD + Jinja + SQL)</h1>
    <div class="card" style="border-left-color:#6a1b9a; background:#f3e5f5">
      <h2 style="color:#6a1b9a"><i class="fas fa-terminal"></i> 0) Comandos clave entorno</h2>
      <pre><code class="language-bash"># Crear y activar entorno virtual (Git Bash)
python -m venv .venv
source .venv/Scripts/activate
# PowerShell:
# python -m venv .venv
# ./.venv/Scripts/Activate.ps1

# Instalar dependencias mÃ­nimas
pip install Flask gunicorn

# Congelar versiones (revisar y limpiar)
pip freeze > requirements.txt

# Ejecutar app local
python app.py  # (asegÃºrate de crear la DB: python db.py si aplica)

# Salir del entorno
deactivate</code></pre>
    </div>
    <div class="grid">
      <div class="card">
        <h2><i class="fas fa-seedling"></i> 1) MÃ­nimo Flask</h2>
        <pre><code class="language-python">from flask import Flask, render_template
app = Flask(__name__)
@app.route('/')
def home():
    return render_template('hola.html')
if __name__ == '__main__':
    app.run(debug=True)</code></pre>
        <pre><code class="language-html">&lt;!-- templates/hola.html --&gt;
&lt;h1&gt;Hola ðŸ‘‹&lt;/h1&gt;</code></pre>
      </div>
      <div class="card">
        <h2><i class="fas fa-gem"></i> 2) Jinja bÃ¡sico</h2>
        <pre><code class="language-html">&lt;p&gt;Hola {{ nombre }}&lt;/p&gt;
{% if promedio &gt;= 60 %}Aprobado{% else %}Reprobado{% endif %}
&lt;ul&gt;{% for e in estudiantes %}&lt;li&gt;{{ e.nombre }}&lt;/li&gt;{% endfor %}&lt;/ul&gt;</code></pre>
      </div>
      <div class="card">
        <h2><i class="fas fa-database"></i> 3) SQL esencial</h2>
        <pre><code class="language-sql">CREATE TABLE IF NOT EXISTS estudiantes (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  nombre TEXT NOT NULL,
  grado TEXT NOT NULL,
  promedio REAL NOT NULL
);
INSERT INTO estudiantes(nombre,grado,promedio) VALUES(?,?,?);
SELECT id,nombre,grado,promedio FROM estudiantes;
UPDATE estudiantes SET nombre=?, grado=?, promedio=? WHERE id=?;
DELETE FROM estudiantes WHERE id=?;</code></pre>
      </div>
      <div class="card">
        <h2><i class="fas fa-share-from-square"></i> 4) Formulario â†’ Ruta</h2>
        <pre><code class="language-html">&lt;form method="post" action="/crear"&gt;
  &lt;input name="nombre" required /&gt;
  &lt;input name="grado" required /&gt;
  &lt;input name="promedio" type="number" step="0.1" /&gt;
  &lt;button&gt;Guardar&lt;/button&gt;
&lt;/form&gt;</code></pre>
        <pre><code class="language-python">@app.route('/crear', methods=['POST'])
def crear():
    from flask import request, redirect, url_for, flash
    nombre = request.form['nombre'].strip()
    grado = request.form['grado']
    prom = float(request.form['promedio'])
    # INSERT ... luego
    flash('Creado','success')
    return redirect(url_for('home'))</code></pre>
      </div>
      <div class="card ok">
        <h2><i class="fas fa-cloud-upload-alt"></i> 5) Despliegue (resumen)</h2>
        <ul>
          <li>GitHub Pages: solo HTML/CSS/JS.</li>
          <li>Render: Flask con <code>requirements.txt</code> y <code>Procfile</code>.</li>
        </ul>
        <pre><code class="language-text">requirements.txt
Flask==3.0.0
gunicorn==21.2.0
Jinja2==3.1.2
Werkzeug==3.0.0
click==8.1.7
# pysqlite3-binary==0.5.3  # solo si tu Python no trae sqlite3

Procfile
web: gunicorn app:app --log-file -</code></pre>
        <pre><code class="language-bash"># Pasos Render
# 1. Subir repo a GitHub
# 2. Crear servicio Web en Render y conectar repo
# 3. Start command: gunicorn app:app
# 4. Verificar URL pÃºblica (CRUD operativo)
# 5. Revisar logs si falla</code></pre>
      </div>
      <div class="card warn">
        <h2><i class="fas fa-bug"></i> 6) Errores comunes</h2>
        <ul>
          <li>ImportError Flask â†’ activar venv e instalar.</li>
          <li>no such table â†’ crear tabla (init_db()).</li>
          <li>405 â†’ ruta con methods=['POST'] y form method="post".</li>
          <li>JSON invÃ¡lido â†’ solo tipos primitivos.</li>
        </ul>
        <pre><code class="language-bash"># DiagnÃ³stico rÃ¡pido
python -c "import flask,sqlite3; print('âœ“ Flask y sqlite3 OK')"
sqlite3 escuela.db ".tables"          # Ver tablas
curl http://localhost:5000/            # Probar raÃ­z
curl http://localhost:5000/api/estadisticas  # Endpoint JSON (si existe)</code></pre>
      </div>
      <div class="card" style="border-left-color:#004d40; background:#e0f2f1">
        <h2 style="color:#004d40"><i class="fas fa-bolt"></i> 7) Bootstrap + Chart.js</h2>
        <pre><code class="language-html">&lt;!-- Bootstrap HEAD --&gt;
&lt;link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"&gt;
&lt;!-- Footer scripts --&gt;
&lt;script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"&gt;&lt;/script&gt;
&lt;script src="https://cdn.jsdelivr.net/npm/chart.js"&gt;&lt;/script&gt;
&lt;canvas id="graf" height="120"&gt;&lt;/canvas&gt;
&lt;script&gt;new Chart(document.getElementById('graf'),{type:'bar',data:{labels:['A','B','C'],datasets:[{label:'Vals',data:[3,5,2],backgroundColor:'#1976d2'}]}});&lt;/script&gt;</code></pre>
      </div>
      <div class="card" style="border-left-color:#1a237e; background:#e8eaf6">
        <h2 style="color:#1a237e"><i class="fas fa-route"></i> 8) Patrones Rutas CRUD</h2>
        <pre><code class="language-python">@app.route('/estudiantes')              # LISTAR
@app.route('/estudiantes/nuevo', methods=['POST'])  # CREAR
@app.route('/estudiantes/<int:id>/editar', methods=['POST'])  # ACTUALIZAR
@app.route('/estudiantes/<int:id>/eliminar', methods=['POST'])  # ELIMINAR</code></pre>
        <pre><code class="language-bash"># Convenciones:
# plural para colecciÃ³n: /estudiantes
# singular + id para acciÃ³n sobre uno: /estudiantes/12/editar
# POST para mutaciones; GET para lectura
# Validar entrada antes de escribir a DB</code></pre>
      </div>
    </div>
    <div class="footer">Sugerencia: empieza pequeÃ±o (una ruta y una plantilla), prueba que funcione y luego agrega el resto.</div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-markup.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-sql.min.js"></script>
</body>
</html>
